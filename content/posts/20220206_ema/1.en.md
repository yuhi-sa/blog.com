---
title: "Frequency Characteristics of Exponential Moving Averages Filter"
date: 2022-02-06T14:00:23+09:00
draft: false
tags: ["Filtering"] 
---
<!--more-->
## Exponential Moving Averages (EMA)
Exponential Moving Averages (EMA) is a popular method for smoothing time series data, where the input $x$ is smoothed over time with a smoothing factor $\beta$ to obtain $y$. The method assigns weights to the previous filtered value and the current observation using $\beta$, allowing recent data to be given greater importance while retaining some information from older data.

$$y_t=\beta y_{t-1}+(1-\beta)x_t$$

## Frequency Characteristics: Gain and Phase

The frequency characteristics of a filter describe how the frequency components of an input signal are altered by the filter. This is typically analyzed using the filter's transfer function.

Applying the Z-transform (used for analyzing discrete-time systems) to the EMA equation, we get the transfer function $G(z)$:

$ Y(z) = (1 - \alpha) z^{-1} Y(z) + \alpha X(z) $
$ G(z) = \frac{Y(z)}{X(z)} = \frac{\alpha}{1 - (1 - \alpha) z^{-1}} $

By substituting $z = e^{j\omega T}$ (where $T$ is the sampling period, assumed to be $T=1$ here), we obtain the frequency response $G(j\omega)$:

$ G(j\omega) = \frac{\alpha}{1 - (1 - \alpha) e^{-j\omega}} $

From this frequency response, we can derive the gain characteristic $|G(j\omega)|$ and the phase characteristic $\angle G(j\omega)|$.

### Gain Characteristic

$ |G(j\omega)| = \frac{\alpha}{\sqrt{1 - 2(1 - \alpha) \cos \omega + (1 - \alpha)^2}} $

### Phase Characteristic

$ \angle G(j\omega) = \arctan\left(\frac{(1 - \alpha) \sin \omega}{1 - (1 - \alpha) \cos \omega}\right) $

**Discussion**:
-   **Small $\alpha$ (e.g., $\alpha=0.1$)**: The filter's frequency bandwidth becomes narrower, resulting in a stronger smoothing effect. However, this also leads to a larger phase lag.
-   **Large $\alpha$ (e.g., $\alpha=0.9$)**: The smoothing capability decreases, but the phase lag is smaller.

This demonstrates a trade-off between the degree of smoothing and the response speed (phase lag).


## Program
```python
import math
import matplotlib.pyplot as plt

BETA = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]
LENGE = 300
frequency = [[] for _ in range(len(BETA))]
gain  = [[] for _ in range(len(BETA))]
phase = [[] for _ in range(len(BETA))]

def get_gain(beta, w):
    return beta / math.sqrt(1-2*(1-beta)*math.cos(w)+(1-beta)*(1-beta))

def get_phase(beta, w):
    return math.atan(-math.sin(w)/(math.cos(w)-(1-beta)))

for beta_index in range(len(BETA)):
    for w in range(LENGE):
        frequency[beta_index].append(w/100)
        gain[beta_index].append(get_gain(BETA[beta_index], w/100))
        phase[beta_index].append(get_phase(BETA[beta_index], w/100))

plt.figure()
plt.xlabel('Frequency(rad/s)')
plt.ylabel('Gain[dB]')
for beta_index in range(len(BETA)):
    plt.plot(frequency[beta_index], gain[beta_index], label="beta="+str(BETA[beta_index]))
plt.legend(bbox_to_anchor=(1.05, 1.0), loc='upper left')
plt.show()

plt.figure()
plt.xlabel('Frequency(rad/s)')
plt.ylabel('Phase[deg]')
for beta_index in range(len(BETA)):
    plt.plot(frequency[beta_index], phase[beta_index], label="beta="+str(BETA[beta_index]))
plt.legend(bbox_to_anchor=(1.05, 1.0), loc='upper left')
plt.show()
```

## Reference
- [Simple Exponential Smoothing and Its Control Parameter: A Reassessment](https://www.researchgate.net/publication/331807228_Simple_Exponential_Smoothing_and_Its_Control_Parameter_A_Reassessment)
