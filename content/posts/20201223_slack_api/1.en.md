---
title: "How to Send Experiment Results (Text and Images) to Slack with Python"
date: 2020-12-23T15:17:23+09:00
draft: false
description: "Learn how to send text messages and images to Slack using Python with Incoming Webhooks and the files.upload API for experiment notifications."
tags: ["Python", "Slack"]
---

<!--more-->

When long-running tasks such as machine learning experiments finish, it is very useful to send notifications with the results to Slack. This article explains how to send text messages and images to Slack using Python.

## 1. Sending Text (Incoming Webhook)

Incoming Webhooks are the simplest way to post messages to Slack from external applications. By sending an HTTP request to a specific URL, you can post messages to a designated channel.

### Slack Configuration

1.  In Slack, go to "Settings & administration" and select "Manage apps."
    ![Slack settings and administration menu](/posts/20201223_slack_api/fig1.png)

2.  Search for "Incoming Webhooks" in the App Directory and add it to Slack.
    ![Searching for Incoming Webhooks in App Directory](/posts/20201223_slack_api/fig2.png)
    ![Adding Incoming Webhooks to Slack](/posts/20201223_slack_api/fig3.png)

3.  After clicking "Add to Slack," select the channel where you want to post messages and click "Add Incoming Webhooks integration."
    ![Selecting the target channel for webhook](/posts/20201223_slack_api/fig4.png)

4.  Copy the generated "Webhook URL." **Be careful not to expose this URL publicly.**
    ![Generated Webhook URL display](/posts/20201223_slack_api/fig5.png)

5.  On the configuration page, you can also customize the notification icon and bot name.
    ![Customizing webhook icon and bot name](/posts/20201223_slack_api/fig6.png)

### Python Code

The `slackweb` library makes it easy to implement notifications.

```bash
pip install slackweb
```

```python
import slackweb

# Set the Webhook URL copied from the configuration
slack = slackweb.Slack(url="YOUR_WEBHOOK_URL")

def notify_text(title, text, color):
    """
    Sends a text notification to Slack.

    :param title: Message title
    :param text: Message body
    :param color: Color of the left border ('good', 'warning', 'danger', or hex color code)
    """
    attachments = [{
        "title": title,
        "text": text,
        "color": color,
        "footer": "Sent from Python Script",
    }]
    slack.notify(attachments=attachments)

# --- Examples ---
notify_text("Experiment Complete", "Model A training finished.", "good")
notify_text("Warning", "Disk space is running low.", "warning")
notify_text("Error", "An exception occurred during training.", "danger")
```

- **Note**: Formatting messages with `attachments` is now considered a legacy approach. For richer message formatting, [Block Kit](https://api.slack.com/block-kit) is recommended.

### Result

![Slack text notification result](/posts/20201223_slack_api/fig7.png)

---

## 2. Sending Images (files.upload API)

To send image files such as experiment result graphs, use the Slack API's `files.upload` method. This requires a different authentication credential (API token) than Incoming Webhooks.

### Slack Configuration

1.  Go to the [Slack API site](https://api.slack.com/apps) and create a new app under "Create New App."
2.  Navigate to "OAuth & Permissions" in the app management page.
3.  In the "Scopes" section under "Bot Token Scopes," add the "`files:write`" scope. This grants the app permission to upload files.
4.  Click "Install to Workspace" at the top of the page to install the app and authorize it.
5.  After installation, the "Bot User OAuth Token" will be displayed. Copy this token (it usually starts with `xoxb-`). **Keep this token secure and do not expose it publicly.**

### Python Code

Use the `requests` library to send API requests.

```python
import requests

def notify_image(channel, title, image_path, token):
    """
    Uploads an image to Slack.

    :param channel: Target channel name (e.g., '#general')
    :param title: Image title
    :param image_path: File path of the image to upload
    :param token: Slack app's Bot User OAuth Token
    """
    files = {'file': open(image_path, 'rb')}
    params = {
        'token': token,
        'channels': channel,
        'title': title,
    }
    requests.post(url="https://slack.com/api/files.upload", params=params, files=files)

# --- Example ---
SLACK_API_TOKEN = "YOUR_BOT_USER_OAUTH_TOKEN"
CHANNEL_NAME = "#random" # Target channel
IMAGE_FILE_PATH = "test.png" # Image to send

notify_image(CHANNEL_NAME, "Training Results Graph", IMAGE_FILE_PATH, SLACK_API_TOKEN)
```

### Result

![Slack image upload result 1](/posts/20201223_slack_api/fig8.png)
![Slack image upload result 2](/posts/20201223_slack_api/fig9.png)

## References

- [Posting to Slack with Python3](https://qiita.com/shtnkgm/items/4f0e4dcbb9eb52fdf316)
- [Methods for Posting Images to Slack from Programs](https://qiita.com/stkdev/items/992921572eefc7de4ad8)
