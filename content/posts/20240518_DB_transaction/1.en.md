---
title: "Transaction Isolation Levels and the Data Inconsistencies They Prevent"
date: 2024-05-18T09:10:00+09:00
draft: false
tags: ["DB", "Database", "Transaction"]
description: "An overview of database transaction isolation levels from READ UNCOMMITTED to SERIALIZABLE, explaining which data inconsistencies each level prevents."
---

<!--more-->

A **transaction** in databases is a mechanism that treats a series of operations as a single logical unit, guaranteeing that either all succeed or all fail. In environments where multiple transactions execute concurrently, **Isolation Levels** become important for maintaining data consistency.

## Data Inconsistencies in Database Transaction Processing

These are the typical data inconsistency phenomena that can occur when multiple transactions run concurrently.

### 1. Dirty Read

- **Phenomenon**: A transaction A reads data that has been **modified but not yet committed** by another transaction B.
- **Problem**: If transaction B is later rolled back, the data that transaction A read becomes invalid data that never actually existed, undermining data reliability.

### 2. Non-repeatable Read

- **Phenomenon**: When a transaction A reads the same data multiple times, **another transaction B updates (or deletes) the data between reads, resulting in different results**.
- **Problem**: Inconsistent data is provided within transaction A, reducing the reliability and accuracy of transaction processing results.

### 3. Phantom Read

- **Phenomenon**: After executing a query with specific conditions and obtaining results, re-executing the same query returns a **different result set because another transaction has added new rows matching the conditions or deleted existing rows**.
- **Problem**: The consistency of the dataset is not maintained, potentially causing unexpected results in aggregation operations and condition-based data manipulation.

## Transaction Isolation Levels

The ANSI/ISO SQL standard defines four isolation levels to prevent these inconsistencies. Higher isolation levels prevent more types of inconsistencies but may reduce concurrency and have greater performance impact.

### 1. `READ UNCOMMITTED`

- **Inconsistencies prevented**: None
- **Characteristics**: The lowest isolation level. Dirty reads, non-repeatable reads, and phantom reads can all occur. Performance is highest, but data consistency is hardly guaranteed.

### 2. `READ COMMITTED`

- **Inconsistencies prevented**: `Dirty Read`
- **Characteristics**: Reads only data that has been **committed** by other transactions. This prevents dirty reads caused by uncommitted data. However, non-repeatable reads and phantom reads can still occur. This is the default isolation level in many database systems.

### 3. `REPEATABLE READ`

- **Inconsistencies prevented**: `Dirty Read`, `Non-repeatable Read`
- **Characteristics**: Data read at the start of a transaction is protected from changes by other transactions until the transaction ends. This ensures consistent re-reads within the same transaction (preventing non-repeatable reads). However, phantom reads can still occur.

### 4. `SERIALIZABLE`

- **Inconsistencies prevented**: `Dirty Read`, `Non-repeatable Read`, `Phantom Read`
- **Characteristics**: The strictest isolation level. Guarantees that transactions behave as if they were executed completely independently (serially) from other transactions. This prevents all three inconsistencies above. However, concurrency is significantly reduced, and the performance impact is the greatest.

### `SNAPSHOT` Isolation Level (Provided by Some DB Systems)

- **Inconsistencies prevented**: `Dirty Read`, `Non-repeatable Read`, `Phantom Read`
- **Characteristics**: An isolation level provided by some database systems (e.g., SQL Server, Oracle) to achieve higher concurrency while providing data consistency equivalent to `SERIALIZABLE`. A **snapshot** of the database at the start of the transaction is created, and the transaction operates against that snapshot. This prevents changes by other transactions from affecting the current transaction.

It is important to select the appropriate isolation level based on the application's requirements (data consistency, performance, concurrency).

## References

- [MySQL 8.0 Reference Manual: InnoDB Transaction Isolation Levels](https://dev.mysql.com/doc/refman/8.0/ja/innodb-transaction-isolation-levels.html)
- [Prisma ORM: Transactions](https://www.prisma.io/docs/orm/prisma-client/queries/transactions)
- [Transaction Isolation Level - Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B6%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%88%86%E9%9B%A2%E3%83%AC%E3%83%99%E3%83%AB)
