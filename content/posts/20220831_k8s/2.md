---
title: "Kubernetesã‚’ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«æ§‹ç¯‰ã™ã‚‹"
date: 2022-08-31T10:00:23+09:00
draft: false
tags: ["k8s"] 
---
<!--more-->
# Kubernetes(k8s)ã¨ã¯
ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãªã©ã®ç®¡ç†ã‚’è‡ªå‹•åŒ–ã™ã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚
k8sã§ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã™ã‚‹ãƒãƒ¼ãƒ‰ã‚’k8sãƒãƒ¼ãƒ‰ã¨å‘¼ã³ã€ãã‚Œã‚‰ã‚’ç®¡ç†ã™ã‚‹ãƒãƒ¼ãƒ‰k8sãƒã‚¹ã‚¿ãƒ¼ã¨å‘¼ã¶ã€‚ãƒãƒ¼ãƒ‰ã®é›†åˆä½“ãŒk8sã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã§ã‚ã‚‹ã€‚

# Minikube
Minikubeã¯SIG-Cluster-Lifecycleã§ä½œã‚‰ã‚ŒãŸç°¡å˜ã«ãƒ­ãƒ¼ã‚«ãƒ«ã«k8sã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’æ§‹ç¯‰ãƒ»å®Ÿè¡Œã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹ã€‚
Minikubeã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã®ä»®è£…ãƒã‚·ãƒ³ä¸Šã«k8sã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã€ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼ãŒå¿…è¦ã¨ãªã‚‹ã€‚

ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼ã”ã¨ã«å¿œã˜ãŸDriverã‚’ä½¿ç”¨ã—ã¦æ“ä½œã™ã‚‹ã“ã¨ã§ã€è‡ªå‹•çš„ã«ãƒ›ã‚¹ãƒˆã¨ãªã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚„ä»®æƒ³ãƒã‚·ãƒ³ã‚’ä½œæˆã—ã€
ãã®ç’°å¢ƒä¸Šã«k8sã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

macOSã«ãŠã‘ã‚‹ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼ã«ã¯Docker/HyperKit driver/VirtualBox/Parallels/Vmware/Fusion/Podmanãªã©ãŒã‚ã‚‹ã€‚

ç¾çŠ¶ã€M1macã§ã¯dockerã—ã‹å¯¾å¿œã—ã¦ãªã•ãã†ã€ã€ï¼Ÿ
- [M1 Macã«ãŠã‘ã‚‹Hyperkitã¨ãã‚ŒãŒå¿…è¦ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ©ç”¨ã«ã¤ã„ã¦](https://ytooyama.hatenadiary.jp/entry/2021/06/04/154320)

## Minikubeã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```sh
$ brew install minikube
==> Downloading https://ghcr.io/v2/homebrew/core/kubernetes-cli/manifests/1.25.0
######################################################################## 100.0%
==> Downloading https://ghcr.io/v2/homebrew/core/kubernetes-cli/blobs/sha256:e10
==> Downloading from https://pkg-containers.githubusercontent.com/ghcr1/blobs/sh
######################################################################## 100.0%
==> Downloading https://ghcr.io/v2/homebrew/core/minikube/manifests/1.26.1
######################################################################## 100.0%
==> Downloading https://ghcr.io/v2/homebrew/core/minikube/blobs/sha256:ae9660e6a
==> Downloading from https://pkg-containers.githubusercontent.com/ghcr1/blobs/sh
######################################################################## 100.0%
==> Installing dependencies for minikube: kubernetes-cli
==> Installing minikube dependency: kubernetes-cli
==> Pouring kubernetes-cli--1.25.0.arm64_monterey.bottle.tar.gz
ğŸº  /opt/homebrew/Cellar/kubernetes-cli/1.25.0: 228 files, 52.8MB
==> Installing minikube
==> Pouring minikube--1.26.1.arm64_monterey.bottle.tar.gz
==> Caveats
zsh completions have been installed to:
  /opt/homebrew/share/zsh/site-functions
==> Summary
ğŸº  /opt/homebrew/Cellar/minikube/1.26.1: 9 files, 70.6MB
==> Running `brew cleanup minikube`...
Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.
Hide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`).
==> Caveats
==> minikube
zsh completions have been installed to:
  /opt/homebrew/share/zsh/site-functions
```

## Minikubeã‚’ä½¿ç”¨ã—ã¦k8sç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹
```sh
$ minikube start
ğŸ˜„  Darwin 12.5.1 (arm64) ä¸Šã® minikube v1.26.1
âœ¨  docker ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒè‡ªå‹•çš„ã«é¸æŠã•ã‚Œã¾ã—ãŸ
ğŸ“Œ  root æ¨©é™ã‚’æŒã¤ Docker Desktop ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ä½¿ç”¨
ğŸ‘  minikube ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ä¸­ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã® minikube ãƒãƒ¼ãƒ‰ã‚’èµ·å‹•ã—ã¦ã„ã¾ã™
ğŸšœ  ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å–å¾—ã—ã¦ã„ã¾ã™...
ğŸ’¾  ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ Kubernetes v1.24.3 ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™...
    > preloaded-images-k8s-v18-v1...:  342.82 MiB / 342.82 MiB  100.00% 20.69 M
    > gcr.io/k8s-minikube/kicbase:  348.00 MiB / 348.00 MiB  100.00% 10.00 MiB 
    > gcr.io/k8s-minikube/kicbase:  0 B [________________________] ?% ? p/s 27s
ğŸ”¥  docker container (CPUs=2, Memory=2200MB) ã‚’ä½œæˆã—ã¦ã„ã¾ã™...
ğŸ³  Docker 20.10.17 ã§ Kubernetes v1.24.3 ã‚’æº–å‚™ã—ã¦ã„ã¾ã™...
    â–ª è¨¼æ˜æ›¸ã¨éµã‚’ä½œæˆã—ã¦ã„ã¾ã™...
    â–ª ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã‚’èµ·å‹•ã—ã¦ã„ã¾ã™...
    â–ª RBAC ã®ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šä¸­ã§ã™...
ğŸ”  Kubernetes ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ¤œè¨¼ã—ã¦ã„ã¾ã™...
    â–ª gcr.io/k8s-minikube/storage-provisioner:v5 ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™
ğŸŒŸ  æœ‰åŠ¹ãªã‚¢ãƒ‰ã‚ªãƒ³: storage-provisioner, default-storageclass
ğŸ„  çµ‚äº†ã—ã¾ã—ãŸï¼kubectl ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã€Œminikubeã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨ã€Œdefaultã€ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†è¨­å®šã•ã‚Œã¾ã—ãŸ
```

## Contextã®åˆ‡ã‚Šæ›¿ãˆ
è¤‡æ•°ã®k8sã‚¯ãƒ©ã‚¹ã‚¿ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯k8sã®Contextã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
```sh
$ kubectl config use-context minikube
Switched to context "minikube".
```

## ãƒãƒ¼ãƒ‰ã®ç¢ºèª
minikubeãŒk8sãƒãƒ¼ãƒ‰ã¨ã—ã¦èªè­˜ã•ã‚Œã¦ã„ã‚‹ã€‚
```sh
$ kubectl get nodes
NAME       STATUS   ROLES           AGE     VERSION
minikube   Ready    control-plane   4m41s   v1.24.3
```

## minikubeã‚¯ãƒ©ã‚¹ã‚¿ã®å‰Šé™¤
```sh
$ minikube delete
ğŸ”¥  docker ã®ã€Œminikubeã€ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™...
ğŸ”¥  ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã€Œminikubeã€ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™...
ğŸ”¥  /Users/yuhi-sa/.minikube/machines/minikube ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™...
ğŸ’€  ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã€Œminikubeã€ã®å…¨ã¦ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚
```

# å‚è€ƒ
- [é’å±±çœŸä¹Ÿ,Kuberneteså®Œå…¨ã‚¬ã‚¤ãƒ‰ ç¬¬2ç‰ˆ impress top gearã‚·ãƒªãƒ¼ã‚º](https://amzn.to/3KwZjKm)